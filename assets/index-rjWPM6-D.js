import{d as O,aQ as j,aI as k,ah as B,o as D,c as E,u as A}from"./index-gVmBTWk7.js";import{W as H,P as I,O as R,S as T,C as G,ah as V,D as q,ai as N,aj as Q,j as d,ak as U,v as $,r as J,z as K,a as X,ad as Y}from"./OrbitControls-BhXoMS-P.js";import{G as Z}from"./GLTFLoader-B9cADE-t.js";import"./BufferGeometryUtils-CKXThuvA.js";const tt=["id"],rt=O({__name:"index",setup(et){const C=j();let b=!0;function P(){const x=document.getElementById(C),l=new H({antialias:!0,canvas:x});l.shadowMap.enabled=!0;const _=45,S=2,W=.1,L=100,p=new I(_,S,W,L);p.position.set(-5.4,4.2,-5.4);const m=new R(p,x);m.target.set(0,-2.5,0),m.update();const s=new T;s.background=new G("#DEFEFF");{const t=new V(11657727,12155424,2);s.add(t)}{let n=function(){t.updateMatrixWorld(),t.target.updateMatrixWorld(),h.update(),t.shadow.camera.updateProjectionMatrix(),r.update()};const t=new q(16777215,2.5);t.castShadow=!0,t.position.set(-5,1.4,.6),t.target.position.set(0,0,0),t.shadow.bias=-.01,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,s.add(t),s.add(t.target);const o=t.shadow.camera;o.near=1,o.far=10,o.left=-4,o.right=2,o.top=2,o.bottom=-2;const r=new N(o);s.add(r),r.visible=!1;const h=new Q(t);s.add(h),h.visible=!1,n()}let u,c;{const n=[[1.118281,5.115846,-3.681386],[3.948875,5.115846,-3.641834],[3.960072,5.115846,-.240352],[3.985447,5.115846,4.585005],[-3.793631,5.115846,4.585006],[-3.826839,5.115846,-14.7362],[-14.542292,5.115846,-14.765865],[-14.520929,5.115846,-3.627002],[-5.452815,5.115846,-3.634418],[-5.467251,5.115846,4.549161],[-13.266233,5.115846,4.567083],[-13.250067,5.115846,-13.499271],[4.081842,5.115846,-13.435463],[4.125436,5.115846,-5.334928],[-14.521364,5.115846,-5.239871],[-14.510466,5.115846,5.486727],[5.745666,5.115846,5.510492],[5.787942,5.115846,-14.728308],[-5.42372,5.115846,-14.761919],[-5.373599,5.115846,-3.704133],[1.004861,5.115846,-3.641834]],e=new d,a=new d;u=new U(n.map((t,o)=>(e.set(...t),a.set(...n[(o+1)%n.length]),[new d().copy(e),new d().lerpVectors(e,a,.1),new d().lerpVectors(e,a,.9)])).flat(),!0);{const t=u.getPoints(250),o=new $().setFromPoints(t),r=new J({color:16711680});c=new K(o,r),c.scale.set(.23,.23,.23),c.position.y=-1.43,c.visible=!1,r.depthTest=!1,c.renderOrder=1,s.add(c)}}const y=[];new Z().load("./glb/MiniCity.glb",e=>{const a=e.scene;s.add(a),a.traverse(i=>{i.castShadow!==void 0&&(i.castShadow=!0,i.receiveShadow=!0)});const t=a.getObjectByName("Cars"),o=[{prefix:"Car_08",y:0,rot:[Math.PI*.5,0,Math.PI*.5]},{prefix:"CAR_03",y:.075,rot:[0,Math.PI,0]},{prefix:"Car_04",y:.095,rot:[0,Math.PI,0]}];a.updateMatrixWorld();for(const i of t.children.slice()){const M=o.find(F=>i.name.startsWith(F.prefix)),g=new X;i.getWorldPosition(g.position),i.position.set(0,M.y,0),i.rotation.set(...M.rot),g.add(i),s.add(g),y.push(g)}const h=new Y().setFromObject(a).getSize(new d).length();m.maxDistance=h*10,m.update()});function z(n){const e=n.domElement,a=e.clientWidth,t=e.clientHeight,o=e.width!==a||e.height!==t;return o&&n.setSize(a,t,!1),o}const f=new d,w=new d;function v(n){if(n*=.001,z(l)){const e=l.domElement;p.aspect=e.clientWidth/e.clientHeight,p.updateProjectionMatrix()}{const e=n*.01,a=.01;y.forEach((t,o)=>{const r=e+o/y.length;u.getPointAt(r%1,f),f.applyMatrix4(c.matrixWorld),u.getPointAt((r+a)%1,w),w.applyMatrix4(c.matrixWorld),t.position.copy(f),t.lookAt(w),t.position.lerpVectors(f,w,.5)})}l.render(s,p),b&&requestAnimationFrame(v)}requestAnimationFrame(v)}return k(()=>{P()}),B(()=>{b=!1}),(x,l)=>(D(),E("canvas",{id:A(C)},null,8,tt))}});export{rt as default};
