import{d as ie,aO as ce,I as de,ay as le,c as me,o as ue,u as pe,ah as he}from"./index-Qjn_ELpF.js";import{W as fe,P as ge,O as we,S as ve,C as H,T as _e,e as xe,ao as P,w as be,H as M,g as ye,am as Me,a as w,al as Ee,Z as p,B as ze,y as Se}from"./OrbitControls-CPTnKnEB.js";import{m as Ae}from"./BufferGeometryUtils-BfTMPg7f.js";const Re=["id"],Be=109/1e3,Fe=ie({__name:"index",setup(De,{expose:C}){const E=ce(),z=de(0);function F(){const v=document.getElementById(E),h=new fe({antialias:!0,canvas:v}),L=60,T=2,W=.1,q=100,u=new ge(L,T,W,q);u.position.z=2.5;const c=new we(u,v);c.enableDamping=!0,c.enablePan=!1,c.minDistance=1.2,c.maxDistance=4,c.update();const d=new ve;d.background=new H("black");{const e=new _e().load("three/world.jpg",()=>f(!0));e.colorSpace=xe;const t=new P(1,64,32),n=new be({map:e});d.add(new M(t,n))}{const t=new ye(16777215,500);t.position.set(-11.73,0,0),d.add(t);const n=new P(Be,64,32),s=new Me({emissive:"#F0AE20"}),i=new M(n,s);i.position.set(-11.73,0,0),d.add(i)}async function G(o){return(await fetch(o)).text()}function O(o){const e=[],t={data:e};let n,s;return o.split(`
`).forEach(i=>{const a=i.trim().split(/\s+/);if(a.length===2)t[a[0]]=parseFloat(a[1]);else if(a.length>2){const l=a.map(m=>{const r=parseFloat(m);if(r!==t.NODATA_value)return n=Math.max(n===void 0?r:n,r),s=Math.min(s===void 0?r:s,r),r});e.push(l)}}),Object.assign(t,{min:s,max:n})}function I(o){const{min:e,max:t,data:n}=o,s=t-e,i=new w;d.add(i);const a=new w;i.add(a);const l=new w;l.position.z=1,a.add(l);const m=new w;m.position.z=.5,l.add(m);const r=new H,k=Math.PI*1.5,U=Math.PI*-.4722222222222222,S=[];n.forEach((J,K)=>{J.forEach((A,Q)=>{if(A===void 0)return;const b=(A-e)/s,X=1,Y=1,$=1,g=new Ee(X,Y,$);i.rotation.y=p.degToRad(Q)+k,a.rotation.x=p.degToRad(K)+U,l.scale.set(.005,.005,p.lerp(.01,.5,b)),m.updateWorldMatrix(!0,!1),g.applyMatrix4(m.matrixWorld);const ee=p.lerp(.7,.3,b),te=1,ne=p.lerp(.4,1,b);r.setHSL(ee,te,ne);const oe=r.toArray().map(B=>B*255),se=g.getAttribute("position").count,R=3,y=new Uint8Array(R*se);y.forEach((B,D)=>{y[D]=oe[D%3]});const ae=!0,re=new ze(y,R,ae);g.setAttribute("color",re),S.push(g)})});const N=Ae(S,!1),V=new Se({vertexColors:!0}),Z=new M(N,V);d.add(Z)}G("three/gpw_v4_basic_demographic_characteristics_rev10_a000_014mt_2010_cntm_1_deg.asc").then(O).then(I).then(()=>f(!0));function j(o){const e=o.domElement,t=e.clientWidth,n=e.clientHeight,s=e.width!==t||e.height!==n;return s&&o.setSize(t,n,!1),s}let _=!1;function f(o){if(_=!1,j(h)){const e=h.domElement;u.aspect=e.clientWidth/e.clientHeight,u.updateProjectionMatrix()}c.update(),h.render(d,u),o&&(z.value+=50)}f();function x(){_||(_=!0,requestAnimationFrame(()=>f()))}c.addEventListener("change",x),window.addEventListener("resize",x),he(()=>{window.removeEventListener("resize",x)})}return le(()=>{F()}),C({percentage:z}),(v,h)=>(ue(),me("canvas",{id:pe(E)},null,8,Re))}});export{Fe as default};
