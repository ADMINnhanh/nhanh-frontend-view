import{y as se,cU as j,p as T,cV as ee,cW as ce,cX as fe,A as V,q as de,G as te,av as ve,cr as pe,cY as c,bq as ge,bi as B,g as k,u as W,d as ne,cZ as he,l as ye,ae as me,Z as we,aw as Se,w as J,o as be,W as q,az as Y,b as K,a1 as Ee,a3 as xe,c_ as De,_ as Me}from"./index-DpK4wnXH.js";import{N as Oe}from"./Ellipsis-EpTkTnfi.js";function G(e){return ce()?(fe(e),!0):!1}const $=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ke=Object.prototype.toString,oe=e=>ke.call(e)==="[object Object]",Ae=()=>{},Z=Ne();function Ne(){var e,n;return $&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function re(...e){if(e.length!==1)return se(...e);const n=e[0];return typeof n=="function"?j(ee(()=>({get:n,set:Ae}))):T(n)}function We(e,n){function t(...a){return new Promise((i,d)=>{Promise.resolve(e(()=>n.apply(this,a),{fn:n,thisArg:this,args:a})).then(i).catch(d)})}return t}const le=e=>e();function _e(e=le,n={}){const{initialState:t="active"}=n,a=re(t==="active");function i(){a.value=!1}function d(){a.value=!0}const p=(...o)=>{a.value&&e(...o)};return{isActive:j(a),pause:i,resume:d,eventFilter:p}}function C(e){return Array.isArray(e)?e:[e]}function Ce(e){return ge()}function Te(e,n,t={}){const{eventFilter:a=le,...i}=t;return V(e,We(a,n),i)}function Pe(e,n,t={}){const{eventFilter:a,initialState:i="active",...d}=t,{eventFilter:p,pause:o,resume:r,isActive:l}=_e(a,{initialState:i});return{stop:Te(e,n,{...d,eventFilter:p}),pause:o,resume:r,isActive:l}}function Le(e,n={}){if(!ve(e))return pe(e);const t=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const a in e.value)t[a]=ee(()=>({get(){return e.value[a]},set(i){var d;if((d=c(n.replaceRef))!=null?d:!0)if(Array.isArray(e.value)){const o=[...e.value];o[a]=i,e.value=o}else{const o={...e.value,[a]:i};Object.setPrototypeOf(o,Object.getPrototypeOf(e.value)),e.value=o}else e.value[a]=i}}));return t}function Ve(e,n=!0,t){Ce()?de(e,t):n?e():te(e)}function ae(e,n,t){return V(e,n,{...t,immediate:!0})}const I=$?window:void 0;function $e(e){var n;const t=c(e);return(n=t==null?void 0:t.$el)!=null?n:t}function L(...e){const n=[],t=()=>{n.forEach(o=>o()),n.length=0},a=(o,r,l,s)=>(o.addEventListener(r,l,s),()=>o.removeEventListener(r,l,s)),i=k(()=>{const o=C(c(e[0])).filter(r=>r!=null);return o.every(r=>typeof r!="string")?o:void 0}),d=ae(()=>{var o,r;return[(r=(o=i.value)==null?void 0:o.map(l=>$e(l)))!=null?r:[I].filter(l=>l!=null),C(c(i.value?e[1]:e[0])),C(W(i.value?e[2]:e[1])),c(i.value?e[3]:e[2])]},([o,r,l,s])=>{if(t(),!(o!=null&&o.length)||!(r!=null&&r.length)||!(l!=null&&l.length))return;const v=oe(s)?{...s}:s;n.push(...o.flatMap(h=>r.flatMap(g=>l.map(w=>a(h,g,w,v)))))},{flush:"post"}),p=()=>{d(),t()};return G(t),p}const R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z="__vueuse_ssr_handlers__",Fe=Re();function Re(){return z in R||(R[z]=R[z]||{}),R[z]}function ze(e,n){return Fe[e]||n}function Ie(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Be={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Q="vueuse-storage";function He(e,n,t,a={}){var i;const{flush:d="pre",deep:p=!0,listenToStorageChanges:o=!0,writeDefaults:r=!0,mergeDefaults:l=!1,shallow:s,window:v=I,eventFilter:h,onError:g=u=>{console.error(u)},initOnMounted:w}=a,A=(s?B:T)(typeof n=="function"?n():n),y=k(()=>c(e));if(!t)try{t=ze("getDefaultStorage",()=>{var u;return(u=I)==null?void 0:u.localStorage})()}catch(u){g(u)}if(!t)return A;const S=c(n),_=Ie(S),M=(i=a.serializer)!=null?i:Be[_],{pause:H,resume:F}=Pe(A,u=>O(u),{flush:d,deep:p,eventFilter:h});V(y,()=>N(),{flush:d});let P=!1;const f=u=>{w&&!P||N(u)},E=u=>{w&&!P||ue(u)};v&&o&&(t instanceof Storage?L(v,"storage",f,{passive:!0}):L(v,Q,E)),w?Ve(()=>{P=!0,N()}):N();function b(u,m){if(v){const D={key:y.value,oldValue:u,newValue:m,storageArea:t};v.dispatchEvent(t instanceof Storage?new StorageEvent("storage",D):new CustomEvent(Q,{detail:D}))}}function O(u){try{const m=t.getItem(y.value);if(u==null)b(m,null),t.removeItem(y.value);else{const D=M.write(u);m!==D&&(t.setItem(y.value,D),b(m,D))}}catch(m){g(m)}}function x(u){const m=u?u.newValue:t.getItem(y.value);if(m==null)return r&&S!=null&&t.setItem(y.value,M.write(S)),S;if(!u&&l){const D=M.read(m);return typeof l=="function"?l(D,S):_==="object"&&!Array.isArray(D)?{...S,...D}:D}else return typeof m!="string"?m:M.read(m)}function N(u){if(!(u&&u.storageArea!==t)){if(u&&u.key==null){A.value=S;return}if(!(u&&u.key!==y.value)){H();try{const m=M.write(A.value);(u===void 0||(u==null?void 0:u.newValue)!==m)&&(A.value=x(u))}catch(m){g(m)}finally{u?te(F):F()}}}}function ue(u){N(u.detail)}return A}function Je(e,n={}){var t;const{pointerTypes:a,preventDefault:i,stopPropagation:d,exact:p,onMove:o,onEnd:r,onStart:l,initialValue:s,axis:v="both",draggingElement:h=I,containerElement:g,handle:w=e,buttons:A=[0]}=n,y=T((t=c(s))!=null?t:{x:0,y:0}),S=T(),_=f=>a?a.includes(f.pointerType):!0,M=f=>{c(i)&&f.preventDefault(),c(d)&&f.stopPropagation()},H=f=>{var E;if(!c(A).includes(f.button)||c(n.disabled)||!_(f)||c(p)&&f.target!==c(e))return;const b=c(g),O=(E=b==null?void 0:b.getBoundingClientRect)==null?void 0:E.call(b),x=c(e).getBoundingClientRect(),N={x:f.clientX-(b?x.left-O.left+b.scrollLeft:x.left),y:f.clientY-(b?x.top-O.top+b.scrollTop:x.top)};(l==null?void 0:l(N,f))!==!1&&(S.value=N,M(f))},F=f=>{if(c(n.disabled)||!_(f)||!S.value)return;const E=c(g),b=c(e).getBoundingClientRect();let{x:O,y:x}=y.value;(v==="x"||v==="both")&&(O=f.clientX-S.value.x,E&&(O=Math.min(Math.max(0,O),E.scrollWidth-b.width))),(v==="y"||v==="both")&&(x=f.clientY-S.value.y,E&&(x=Math.min(Math.max(0,x),E.scrollHeight-b.height))),y.value={x:O,y:x},o==null||o(y.value,f),M(f)},P=f=>{c(n.disabled)||!_(f)||S.value&&(S.value=void 0,r==null||r(y.value,f),M(f))};if($){const f=()=>{var E;return{capture:(E=n.capture)!=null?E:!0,passive:!c(i)}};L(w,"pointerdown",H,f),L(h,"pointermove",F,f),L(h,"pointerup",P,f)}return{...Le(y),position:y,isDragging:k(()=>!!S.value),style:k(()=>`left:${y.value.x}px;top:${y.value.y}px;`)}}const Ye=$?window:void 0;function Ke(e){var n;const t=c(e);return(n=t==null?void 0:t.$el)!=null?n:t}function Ue(...e){const n=[],t=()=>{n.forEach(o=>o()),n.length=0},a=(o,r,l,s)=>(o.addEventListener(r,l,s),()=>o.removeEventListener(r,l,s)),i=k(()=>{const o=C(c(e[0])).filter(r=>r!=null);return o.every(r=>typeof r!="string")?o:void 0}),d=ae(()=>{var o,r;return[(r=(o=i.value)==null?void 0:o.map(l=>Ke(l)))!=null?r:[Ye].filter(l=>l!=null),C(c(i.value?e[1]:e[0])),C(W(i.value?e[2]:e[1])),c(i.value?e[3]:e[2])]},([o,r,l,s])=>{if(t(),!(o!=null&&o.length)||!(r!=null&&r.length)||!(l!=null&&l.length))return;const v=oe(s)?{...s}:s;n.push(...o.flatMap(h=>r.flatMap(g=>l.map(w=>a(h,g,w,v)))))},{flush:"post"}),p=()=>{d(),t()};return G(t),p}const Xe=ne({name:"UseDraggable",props:["storageKey","storageType","initialValue","exact","preventDefault","stopPropagation","pointerTypes","as","handle","axis","onStart","onMove","onEnd","disabled","buttons","containerElement","capture"],setup(e,{slots:n}){const t=B(),a=k(()=>{var s;return(s=c(e.handle))!=null?s:t.value}),i=k(()=>{var s;return(s=e.containerElement)!=null?s:void 0}),d=k(()=>!!e.disabled),p=e.storageKey&&He(e.storageKey,c(e.initialValue)||{x:0,y:0},$?e.storageType==="session"?sessionStorage:localStorage:void 0),o=p||e.initialValue||{x:0,y:0},l=he(Je(t,{...e,handle:a,initialValue:o,onEnd:(s,v)=>{var h;(h=e.onEnd)==null||h.call(e,s,v),p&&(p.value.x=s.x,p.value.y=s.y)},disabled:d,containerElement:i}));return()=>{if(n.default)return ye(e.as||"div",{ref:t,style:`touch-action:none;${l.style}`},n.default(l))}}});function U(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function ie(e){const n=window.getComputedStyle(e);if(n.overflowX==="scroll"||n.overflowY==="scroll"||n.overflowX==="auto"&&e.clientWidth<e.scrollWidth||n.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const t=e.parentNode;return!t||t.tagName==="BODY"?!1:ie(t)}}function Ge(e){const n=e||window.event,t=n.target;return ie(t)?!1:n.touches.length>1?!0:(n.preventDefault&&n.preventDefault(),!1)}const X=new WeakMap;function qe(e,n=!1){const t=B(n);let a=null,i="";V(re(e),o=>{const r=U(c(o));if(r){const l=r;if(X.get(l)||X.set(l,l.style.overflow),l.style.overflow!=="hidden"&&(i=l.style.overflow),l.style.overflow==="hidden")return t.value=!0;if(t.value)return l.style.overflow="hidden"}},{immediate:!0});const d=()=>{const o=U(c(e));!o||t.value||(Z&&(a=Ue(o,"touchmove",r=>{Ge(r)},{passive:!1})),o.style.overflow="hidden",t.value=!0)},p=()=>{const o=U(c(e));!o||!t.value||(Z&&(a==null||a()),o.style.overflow=i,X.delete(o),t.value=!1)};return G(p),k({get(){return t.value},set(o){o?d():p()}})}function Ze(){let e=!1;const n=B(!1);return(t,a)=>{if(n.value=a.value,e)return;e=!0;const i=qe(t,a.value);V(n,d=>i.value=d)}}Ze();const Qe=ne({__name:"Popup",props:{componentName:{},width:{},height:{}},emits:["closure"],setup(e,{emit:n}){const t=e,a=n,i=t.componentName+"-draggable",d={x:(window.innerWidth-t.width)/2,y:(window.innerHeight-t.height)/2},p=T(),o=T();let r=!1;function l(){r=!0}function s(){if(r){r=!1;const v=o.value.$el,h=v.getBoundingClientRect();let{x:g,y:w}=h;g=Math.min(Math.max(0,g),window.innerWidth-100),w=Math.min(Math.max(0,w),window.innerHeight-100),(h.x!=g||h.y!=w)&&(v.style.left=g+"px",v.style.top=w+"px",localStorage.setItem(i,JSON.stringify({x:g,y:w})))}}return window.addEventListener("mouseup",s),me(()=>{window.removeEventListener("mouseup",s)}),(v,h)=>{var g;return be(),we(W(Xe),{ref_key:"useDraggableRef",ref:o,"storage-key":i,"storage-type":"local",handle:(g=p.value)==null?void 0:g.triggerRef,"initial-value":d,class:"popup",style:Se({width:t.width+"px",height:t.height+"px"}),onMousedown:l},{default:J(()=>[q("header",null,[K(W(Oe),{ref_key:"handleRef",ref:p},{default:J(()=>[Y(v.$slots,"header",{},void 0,!0)]),_:3},512),K(W(Ee),null,{default:J(()=>[Y(v.$slots,"tool",{},void 0,!0),q("div",{class:"clickable",onClick:h[0]||(h[0]=w=>a("closure"))},[K(W(xe),{size:"22",component:W(De)},null,8,["component"])])]),_:3})]),Y(v.$slots,"default",{},void 0,!0)]),_:3},8,["handle","style"])}}}),tt=Me(Qe,[["__scopeId","data-v-1ea9ceb9"]]);export{tt as P};
