import{d as k,aP as B,H as D,av as E,ag as H,o as A,c as I,u as R}from"./index-EfoIWUQ8.js";import{W as T,P as G,O as V,S as q,C as N,ah as U,D as J,ai as K,aj as Q,j as d,ak as X,v as Y,r as Z,z as $,a as ee,ad as te}from"./OrbitControls-BhXoMS-P.js";import{G as oe}from"./GLTFLoader-B9cADE-t.js";import"./BufferGeometryUtils-CKXThuvA.js";const ae=["id"],de=k({__name:"index",setup(ne,{expose:_}){const C=B(),v=D(!1);let b=!0;function S(){const x=document.getElementById(C),l=new T({antialias:!0,canvas:x});l.shadowMap.enabled=!0;const W=45,L=2,z=.1,F=100,p=new G(W,L,z,F);p.position.set(-5.4,4.2,-5.4);const h=new V(p,x);h.target.set(0,-2.5,0),h.update();const s=new q;s.background=new N("#DEFEFF");{const e=new U(11657727,12155424,2);s.add(e)}{let n=function(){e.updateMatrixWorld(),e.target.updateMatrixWorld(),m.update(),e.shadow.camera.updateProjectionMatrix(),r.update()};const e=new J(16777215,2.5);e.castShadow=!0,e.position.set(-5,1.4,.6),e.target.position.set(0,0,0),e.shadow.bias=-.01,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,s.add(e),s.add(e.target);const o=e.shadow.camera;o.near=1,o.far=10,o.left=-4,o.right=2,o.top=2,o.bottom=-2;const r=new K(o);s.add(r),r.visible=!1;const m=new Q(e);s.add(m),m.visible=!1,n()}let u,c;{const n=[[1.118281,5.115846,-3.681386],[3.948875,5.115846,-3.641834],[3.960072,5.115846,-.240352],[3.985447,5.115846,4.585005],[-3.793631,5.115846,4.585006],[-3.826839,5.115846,-14.7362],[-14.542292,5.115846,-14.765865],[-14.520929,5.115846,-3.627002],[-5.452815,5.115846,-3.634418],[-5.467251,5.115846,4.549161],[-13.266233,5.115846,4.567083],[-13.250067,5.115846,-13.499271],[4.081842,5.115846,-13.435463],[4.125436,5.115846,-5.334928],[-14.521364,5.115846,-5.239871],[-14.510466,5.115846,5.486727],[5.745666,5.115846,5.510492],[5.787942,5.115846,-14.728308],[-5.42372,5.115846,-14.761919],[-5.373599,5.115846,-3.704133],[1.004861,5.115846,-3.641834]],t=new d,a=new d;u=new X(n.map((e,o)=>(t.set(...e),a.set(...n[(o+1)%n.length]),[new d().copy(t),new d().lerpVectors(t,a,.1),new d().lerpVectors(t,a,.9)])).flat(),!0);{const e=u.getPoints(250),o=new Y().setFromPoints(e),r=new Z({color:16711680});c=new $(o,r),c.scale.set(.23,.23,.23),c.position.y=-1.43,c.visible=!1,r.depthTest=!1,c.renderOrder=1,s.add(c)}}const y=[];new oe().load("./glb/MiniCity.glb",t=>{const a=t.scene;s.add(a),v.value=!0,a.traverse(i=>{i.castShadow!==void 0&&(i.castShadow=!0,i.receiveShadow=!0)});const e=a.getObjectByName("Cars"),o=[{prefix:"Car_08",y:0,rot:[Math.PI*.5,0,Math.PI*.5]},{prefix:"CAR_03",y:.075,rot:[0,Math.PI,0]},{prefix:"Car_04",y:.095,rot:[0,Math.PI,0]}];a.updateMatrixWorld();for(const i of e.children.slice()){const M=o.find(j=>i.name.startsWith(j.prefix)),w=new ee;i.getWorldPosition(w.position),i.position.set(0,M.y,0),i.rotation.set(...M.rot),w.add(i),s.add(w),y.push(w)}const m=new te().setFromObject(a).getSize(new d).length();h.maxDistance=m*10,h.update()});function O(n){const t=n.domElement,a=t.clientWidth,e=t.clientHeight,o=t.width!==a||t.height!==e;return o&&n.setSize(a,e,!1),o}const f=new d,g=new d;function P(n){if(n*=.001,O(l)){const t=l.domElement;p.aspect=t.clientWidth/t.clientHeight,p.updateProjectionMatrix()}{const t=n*.01,a=.01;y.forEach((e,o)=>{const r=t+o/y.length;u.getPointAt(r%1,f),f.applyMatrix4(c.matrixWorld),u.getPointAt((r+a)%1,g),g.applyMatrix4(c.matrixWorld),e.position.copy(f),e.lookAt(g),e.position.lerpVectors(f,g,.5)})}l.render(s,p),b&&requestAnimationFrame(P)}requestAnimationFrame(P)}return E(()=>{S()}),H(()=>{b=!1}),_({percentage:v}),(x,l)=>(A(),I("canvas",{id:R(C)},null,8,ae))}});export{de as default};
