import{d as M,ao as S,q as W,ae as z,c as K,o as R,u as X}from"./index-DjFE_Gz4.js";import{W as Y,P as B,O as I,S as T,D as q,al as F,am as A,H as G,an as N}from"./OrbitControls-CPTnKnEB.js";function Q(D,g){const{canvas:p,inputElement:i}=D,w=new Y({antialias:!0,canvas:p}),E=75,H=2,O=.1,x=100,u=new B(E,H,O,x);u.position.z=4;const b=new I(u,i);b.target.set(0,0,0),b.update();const y=new T;{const a=new q(16777215,1);a.position.set(-1,2,4),y.add(a)}const P=1,j=1,h=1,k=new F(P,j,h);function v(t,n,a){const f=new A({color:n}),l=new G(t,f);return y.add(l),l.position.x=a,l}const C=[v(k,4500104,0),v(k,8930474,-2),v(k,11176004,2)];class L{constructor(){this.raycaster=new N,this.pickedObject=null,this.pickedObjectSavedColor=0}pick(n,a,f,l){this.pickedObject&&(this.pickedObject.material.emissive.setHex(this.pickedObjectSavedColor),this.pickedObject=void 0),this.raycaster.setFromCamera(n,f);const _=this.raycaster.intersectObjects(a.children);_.length&&(this.pickedObject=_[0].object,this.pickedObjectSavedColor=this.pickedObject.material.emissive.getHex(),this.pickedObject.material.emissive.setHex(l*8%2>1?16776960:16711680))}}const m={x:-2,y:-2},e=new L;d();function o(t){const n=t.domElement,a=i.clientWidth,f=i.clientHeight,l=n.width!==a||n.height!==f;return l&&t.setSize(a,f,!1),l}function s(t){t*=.001,o(w)&&(u.aspect=i.clientWidth/i.clientHeight,u.updateProjectionMatrix()),C.forEach((n,a)=>{const f=1+a*.1,l=t*f;n.rotation.x=l,n.rotation.y=l}),e.pick(m,y,u,t),w.render(y,u),(!g||g())&&requestAnimationFrame(s)}requestAnimationFrame(s);function r(t){const n=i.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function c(t){const n=r(t);m.x=n.x/i.clientWidth*2-1,m.y=n.y/i.clientHeight*-2+1}function d(){m.x=-1e5,m.y=-1e5}i.addEventListener("mousemove",c),i.addEventListener("mouseout",d),i.addEventListener("mouseleave",d),i.addEventListener("touchstart",t=>{t.preventDefault(),c(t.touches[0])},{passive:!1}),i.addEventListener("touchmove",t=>{c(t.touches[0])}),i.addEventListener("touchend",d)}const U=["id"],Z=M({__name:"index",setup(D){const g=S(),p=x(["ctrlKey","metaKey","shiftKey","button","pointerType","clientX","clientY","pointerId","pageX","pageY"]),i=x(["deltaX","deltaY"]),w=x(["ctrlKey","metaKey","shiftKey","keyCode"]);function E(e,o){e.preventDefault(),i(e,o)}function H(e){e.preventDefault()}function O(e,o,s){for(const r of o)s[r]=e[r]}function x(e){return function(s,r){const c={type:s.type};O(s,e,c),r(c)}}function u(e,o){e.preventDefault();const s=[],r={type:e.type,touches:s};for(let c=0;c<e.touches.length;++c){const d=e.touches[c];s.push({pageX:d.pageX,pageY:d.pageY,clientX:d.clientX,clientY:d.clientY})}o(r)}const b={37:!0,38:!0,39:!0,40:!0};function y(e,o){const{keyCode:s}=e;b[s]&&(e.preventDefault(),w(e,o))}let P=0;class j{constructor(o,s,r){const c=this;c.id=P++,c.worker=s;const d=n=>{c.worker.postMessage({type:"event",id:c.id,data:n})};s.postMessage({type:"makeProxy",id:c.id}),t();for(const[n,a]of Object.entries(r))o.addEventListener(n,function(f){a(f,d)});function t(){const n=o.getBoundingClientRect();d({type:"size",left:n.left,top:n.top,width:o.clientWidth,height:o.clientHeight})}window.addEventListener("resize",t)}}let h;function k(e){e.focus();const o=e.transferControlToOffscreen();h=new Worker(new URL("/assets/offscreencanvas-worker-orbitcontrols-BQ2f9QoN.js",import.meta.url),{type:"module"});const s={contextmenu:H,mousedown:p,mousemove:p,mouseup:p,pointerdown:p,pointermove:p,pointerup:p,touchstart:u,touchmove:u,touchend:u,wheel:E,keydown:y},r=new j(e,h,s);h.postMessage({type:"start",canvas:o,canvasId:r.id},[o]),console.log("using OffscreenCanvas")}let v=!0;function C(){return v}function L(e){Q({canvas:e,inputElement:e},C),console.log("using regular canvas")}function m(){const e=document.getElementById(g);e.transferControlToOffscreen?k(e):L(e)}return W(()=>{m()}),z(()=>{v=!1,h==null||h.terminate()}),(e,o)=>(R(),K("canvas",{id:X(g)},null,8,U))}});export{Z as default};
