import{d as ce,aP as de,H as le,av as me,o as ue,c as pe,u as he,ag as fe}from"./index-EfoIWUQ8.js";import{W as ge,P as we,O as ve,S as xe,C as H,T as _e,g as be,ao as P,s as Me,x as y,f as ye,am as Ee,a as w,al as Se,J as p,B as ze,M as De}from"./OrbitControls-BhXoMS-P.js";import{m as Re}from"./BufferGeometryUtils-CKXThuvA.js";const Ae=["id"],T=11730/1e3,Be=109/1e3,Fe=ce({__name:"index",setup(He,{expose:C}){const E=de(),S=le(0);function F(){const v=document.getElementById(E),h=new ge({antialias:!0,canvas:v}),L=60,W=2,q=.1,G=100,u=new we(L,W,q,G);u.position.z=2.5;const c=new ve(u,v);c.enableDamping=!0,c.enablePan=!1,c.minDistance=1.2,c.maxDistance=4,c.update();const d=new xe;d.background=new H("black");{const e=new _e().load("three/world.jpg",()=>f(!0));e.colorSpace=be;const t=new P(1,64,32),n=new Me({map:e});d.add(new y(t,n))}{const t=new ye(16777215,500);t.position.set(-T,0,0),d.add(t);const n=new P(Be,64,32),s=new Ee({emissive:"#F0AE20"}),i=new y(n,s);i.position.set(-T,0,0),d.add(i)}async function O(o){return(await fetch(o)).text()}function j(o){const e=[],t={data:e};let n,s;return o.split(`
`).forEach(i=>{const a=i.trim().split(/\s+/);if(a.length===2)t[a[0]]=parseFloat(a[1]);else if(a.length>2){const l=a.map(m=>{const r=parseFloat(m);if(r!==t.NODATA_value)return n=Math.max(n===void 0?r:n,r),s=Math.min(s===void 0?r:s,r),r});e.push(l)}}),Object.assign(t,{min:s,max:n})}function k(o){const{min:e,max:t,data:n}=o,s=t-e,i=new w;d.add(i);const a=new w;i.add(a);const l=new w;l.position.z=1,a.add(l);const m=new w;m.position.z=.5,l.add(m);const r=new H,U=Math.PI*1.5,N=Math.PI*-(85/90/2),z=[];n.forEach((Q,X)=>{Q.forEach((D,Y)=>{if(D===void 0)return;const b=(D-e)/s,Z=1,$=1,ee=1,g=new Se(Z,$,ee);i.rotation.y=p.degToRad(Y)+U,a.rotation.x=p.degToRad(X)+N,l.scale.set(.005,.005,p.lerp(.01,.5,b)),m.updateWorldMatrix(!0,!1),g.applyMatrix4(m.matrixWorld);const te=p.lerp(.7,.3,b),ne=1,oe=p.lerp(.4,1,b);r.setHSL(te,ne,oe);const se=r.toArray().map(A=>A*255),ae=g.getAttribute("position").count,R=3,M=new Uint8Array(R*ae);M.forEach((A,B)=>{M[B]=se[B%3]});const re=!0,ie=new ze(M,R,re);g.setAttribute("color",ie),z.push(g)})});const J=Re(z,!1),V=new De({vertexColors:!0}),K=new y(J,V);d.add(K)}O("three/gpw_v4_basic_demographic_characteristics_rev10_a000_014mt_2010_cntm_1_deg.asc").then(j).then(k).then(()=>f(!0));function I(o){const e=o.domElement,t=e.clientWidth,n=e.clientHeight,s=e.width!==t||e.height!==n;return s&&o.setSize(t,n,!1),s}let x=!1;function f(o){if(x=!1,I(h)){const e=h.domElement;u.aspect=e.clientWidth/e.clientHeight,u.updateProjectionMatrix()}c.update(),h.render(d,u),o&&(S.value+=50)}f();function _(){x||(x=!0,requestAnimationFrame(()=>f()))}c.addEventListener("change",_),window.addEventListener("resize",_),fe(()=>{window.removeEventListener("resize",_)})}return me(()=>{F()}),C({percentage:S}),(v,h)=>(ue(),pe("canvas",{id:he(E)},null,8,Ae))}});export{Fe as default};
