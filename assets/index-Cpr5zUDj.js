import{d as U,cK as B,Q as m,b1 as L,aY as z,w as l,aT as h,cL as y,o as K,b as a,u as o,ch as f,O as R,b2 as O,B as C,e as c,b9 as T}from"./index-SnQg8QuD.js";import{P as _}from"./Popup-BmdiX3pi.js";import{N as q,a as d}from"./FormItem-Dpr6CD_W.js";import{N as v}from"./Input-Cdb7vm1h.js";import{N as P}from"./InputGroup-Dje1OER4.js";import{N}from"./Image-DW6rEp4E.js";import"./Ellipsis-B7cRAvgk.js";import"./use-collection-atymXr3i.js";import"./Suffix-DbiknC0m.js";import"./use-locale-2Ng1HaKl.js";import"./_createCompounder-CruQZFnc.js";import"./download-C2161hUv.js";const H=U({__name:"index",props:{zIndex:{}},emits:["closure"],setup(b,{emit:x}){const I=b,k=x;function s(){k("closure")}B(["#login-popup",".open-login-button"],s,I.zIndex);const p=m("");function w(){const n=y+"/captcha/captchaImage?type=math&s="+Math.random();h.get(n,{responseType:"arraybuffer"}).then(e=>{const r=new Blob([e],{type:"image/jpge"});p.value=URL.createObjectURL(r),t.value.validateCode=""})}w();const t=m({username:"",password:"",validateCode:"",rememberMe:!1}),g=m(),i=L();function u(){var n;(n=g.value)==null||n.validate(e=>{e?window.$message.error("请按要求填写表单"):(i.start(),h.post(y+"/login",t.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(r=>{window.$message.success("登录成功"),T.value.token=r.data.token,i.finish(),s()}).catch(()=>i.error()))})}return(n,e)=>(K(),z(_,{id:"login-popup","component-name":"login",width:400,height:331,onClosure:s,zIndex:b.zIndex},{header:l(()=>[...e[3]||(e[3]=[c("登录",-1)])]),default:l(()=>[a(o(q),{ref_key:"formRef",ref:g,"label-width":"auto","label-placement":"left",model:t.value},{default:l(()=>[a(o(d),{label:"用户名",required:"",path:"username"},{default:l(()=>[a(o(v),{value:t.value.username,"onUpdate:value":e[0]||(e[0]=r=>t.value.username=r),placeholder:"请输入 用户名",clearable:"",onKeyup:f(u,["enter"])},null,8,["value"])]),_:1}),a(o(d),{label:"密码",required:"",path:"password"},{default:l(()=>[a(o(v),{value:t.value.password,"onUpdate:value":e[1]||(e[1]=r=>t.value.password=r),placeholder:"请输入 密码",type:"password","show-password-on":"mousedown",clearable:"",onKeyup:f(u,["enter"])},null,8,["value"])]),_:1}),a(o(d),{label:"验证码",required:"",path:"validateCode"},{default:l(()=>[a(o(P),null,{default:l(()=>[a(o(v),{value:t.value.validateCode,"onUpdate:value":e[2]||(e[2]=r=>t.value.validateCode=r),placeholder:"请输入 验证码",clearable:"",onKeyup:f(u,["enter"])},null,8,["value"]),a(o(R),null,{trigger:l(()=>[a(o(N),{onClick:w,src:p.value,style:{height:"34px",cursor:"pointer"},"preview-disabled":""},null,8,["src"])]),default:l(()=>[a(o(N),{src:p.value,height:"80","preview-disabled":""},null,8,["src"])]),_:1})]),_:1})]),_:1}),a(o(d),{label:" "},{default:l(()=>[a(o(O),null,{default:l(()=>[a(o(C),{onClick:s},{default:l(()=>[...e[4]||(e[4]=[c("取消",-1)])]),_:1}),a(o(C),{type:"primary",onClick:u},{default:l(()=>[...e[5]||(e[5]=[c("登录",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["zIndex"]))}});export{H as default};
