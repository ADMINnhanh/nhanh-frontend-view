import{bK as se,cQ as ce,cR as j,aI as fe,D as ee,cS as de,cT as ve,E as pe,cU as te,J as T,C as V,cV as c,cb as ge,c4 as B,z as N,u as C,d as ne,cW as he,k as ye,ah as me,o as we,aS as Se,w as J,a_ as be,aM as Q,b as K,aK as Y,aZ as Ee,cX as xe,aY as Me,_ as De}from"./index-Bas7IHTD.js";import{N as Oe}from"./Ellipsis-B9AUH6tp.js";function G(e){return de()?(ve(e),!0):!1}const $=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ke=Object.prototype.toString,oe=e=>ke.call(e)==="[object Object]",Ne=()=>{},Z=Ae();function Ae(){var e,n;return $&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function re(...e){if(e.length!==1)return pe(...e);const n=e[0];return typeof n=="function"?te(j(()=>({get:n,set:Ne}))):T(n)}function Ce(e,n){function t(...a){return new Promise((i,d)=>{Promise.resolve(e(()=>n.apply(this,a),{fn:n,thisArg:this,args:a})).then(i).catch(d)})}return t}const le=e=>e();function _e(e=le,n={}){const{initialState:t="active"}=n,a=re(t==="active");function i(){a.value=!1}function d(){a.value=!0}const p=(...o)=>{a.value&&e(...o)};return{isActive:te(a),pause:i,resume:d,eventFilter:p}}function W(e){return Array.isArray(e)?e:[e]}function We(e){return ge()}function Te(e,n,t={}){const{eventFilter:a=le,...i}=t;return V(e,Ce(a,n),i)}function Pe(e,n,t={}){const{eventFilter:a,initialState:i="active",...d}=t,{eventFilter:p,pause:o,resume:r,isActive:l}=_e(a,{initialState:i});return{stop:Te(e,n,{...d,eventFilter:p}),pause:o,resume:r,isActive:l}}function Le(e,n={}){if(!se(e))return ce(e);const t=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const a in e.value)t[a]=j(()=>({get(){return e.value[a]},set(i){var d;if((d=c(n.replaceRef))!=null?d:!0)if(Array.isArray(e.value)){const o=[...e.value];o[a]=i,e.value=o}else{const o={...e.value,[a]:i};Object.setPrototypeOf(o,Object.getPrototypeOf(e.value)),e.value=o}else e.value[a]=i}}));return t}function Ve(e,n=!0,t){We()?fe(e,t):n?e():ee(e)}function ae(e,n,t){return V(e,n,{...t,immediate:!0})}const z=$?window:void 0;function $e(e){var n;const t=c(e);return(n=t==null?void 0:t.$el)!=null?n:t}function L(...e){const n=[],t=()=>{n.forEach(o=>o()),n.length=0},a=(o,r,l,s)=>(o.addEventListener(r,l,s),()=>o.removeEventListener(r,l,s)),i=N(()=>{const o=W(c(e[0])).filter(r=>r!=null);return o.every(r=>typeof r!="string")?o:void 0}),d=ae(()=>{var o,r;return[(r=(o=i.value)==null?void 0:o.map(l=>$e(l)))!=null?r:[z].filter(l=>l!=null),W(c(i.value?e[1]:e[0])),W(C(i.value?e[2]:e[1])),c(i.value?e[3]:e[2])]},([o,r,l,s])=>{if(t(),!(o!=null&&o.length)||!(r!=null&&r.length)||!(l!=null&&l.length))return;const v=oe(s)?{...s}:s;n.push(...o.flatMap(h=>r.flatMap(g=>l.map(m=>a(h,g,m,v)))))},{flush:"post"}),p=()=>{d(),t()};return G(t),p}const F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},I="__vueuse_ssr_handlers__",Re=Fe();function Fe(){return I in F||(F[I]=F[I]||{}),F[I]}function Ie(e,n){return Re[e]||n}function ze(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Be={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},q="vueuse-storage";function He(e,n,t,a={}){var i;const{flush:d="pre",deep:p=!0,listenToStorageChanges:o=!0,writeDefaults:r=!0,mergeDefaults:l=!1,shallow:s,window:v=z,eventFilter:h,onError:g=u=>{console.error(u)},initOnMounted:m}=a,D=(s?B:T)(typeof n=="function"?n():n),y=N(()=>c(e));if(!t)try{t=Ie("getDefaultStorage",()=>{var u;return(u=z)==null?void 0:u.localStorage})()}catch(u){g(u)}if(!t)return D;const w=c(n),_=ze(w),O=(i=a.serializer)!=null?i:Be[_],{pause:H,resume:R}=Pe(D,()=>k(D.value),{flush:d,deep:p,eventFilter:h});V(y,()=>A(),{flush:d});let P=!1;const f=u=>{m&&!P||A(u)},E=u=>{m&&!P||ue(u)};v&&o&&(t instanceof Storage?L(v,"storage",f,{passive:!0}):L(v,q,E)),m?Ve(()=>{P=!0,A()}):A();function b(u,S){if(v){const M={key:y.value,oldValue:u,newValue:S,storageArea:t};v.dispatchEvent(t instanceof Storage?new StorageEvent("storage",M):new CustomEvent(q,{detail:M}))}}function k(u){try{const S=t.getItem(y.value);if(u==null)b(S,null),t.removeItem(y.value);else{const M=O.write(u);S!==M&&(t.setItem(y.value,M),b(S,M))}}catch(S){g(S)}}function x(u){const S=u?u.newValue:t.getItem(y.value);if(S==null)return r&&w!=null&&t.setItem(y.value,O.write(w)),w;if(!u&&l){const M=O.read(S);return typeof l=="function"?l(M,w):_==="object"&&!Array.isArray(M)?{...w,...M}:M}else return typeof S!="string"?S:O.read(S)}function A(u){if(!(u&&u.storageArea!==t)){if(u&&u.key==null){D.value=w;return}if(!(u&&u.key!==y.value)){H();try{(u==null?void 0:u.newValue)!==O.write(D.value)&&(D.value=x(u))}catch(S){g(S)}finally{u?ee(R):R()}}}}function ue(u){A(u.detail)}return D}function Je(e,n={}){var t;const{pointerTypes:a,preventDefault:i,stopPropagation:d,exact:p,onMove:o,onEnd:r,onStart:l,initialValue:s,axis:v="both",draggingElement:h=z,containerElement:g,handle:m=e,buttons:D=[0]}=n,y=T((t=c(s))!=null?t:{x:0,y:0}),w=T(),_=f=>a?a.includes(f.pointerType):!0,O=f=>{c(i)&&f.preventDefault(),c(d)&&f.stopPropagation()},H=f=>{var E;if(!c(D).includes(f.button)||c(n.disabled)||!_(f)||c(p)&&f.target!==c(e))return;const b=c(g),k=(E=b==null?void 0:b.getBoundingClientRect)==null?void 0:E.call(b),x=c(e).getBoundingClientRect(),A={x:f.clientX-(b?x.left-k.left+b.scrollLeft:x.left),y:f.clientY-(b?x.top-k.top+b.scrollTop:x.top)};(l==null?void 0:l(A,f))!==!1&&(w.value=A,O(f))},R=f=>{if(c(n.disabled)||!_(f)||!w.value)return;const E=c(g),b=c(e).getBoundingClientRect();let{x:k,y:x}=y.value;(v==="x"||v==="both")&&(k=f.clientX-w.value.x,E&&(k=Math.min(Math.max(0,k),E.scrollWidth-b.width))),(v==="y"||v==="both")&&(x=f.clientY-w.value.y,E&&(x=Math.min(Math.max(0,x),E.scrollHeight-b.height))),y.value={x:k,y:x},o==null||o(y.value,f),O(f)},P=f=>{c(n.disabled)||!_(f)||w.value&&(w.value=void 0,r==null||r(y.value,f),O(f))};if($){const f=()=>{var E;return{capture:(E=n.capture)!=null?E:!0,passive:!c(i)}};L(m,"pointerdown",H,f),L(h,"pointermove",R,f),L(h,"pointerup",P,f)}return{...Le(y),position:y,isDragging:N(()=>!!w.value),style:N(()=>`left:${y.value.x}px;top:${y.value.y}px;`)}}const Ke=$?window:void 0;function Ye(e){var n;const t=c(e);return(n=t==null?void 0:t.$el)!=null?n:t}function Ue(...e){const n=[],t=()=>{n.forEach(o=>o()),n.length=0},a=(o,r,l,s)=>(o.addEventListener(r,l,s),()=>o.removeEventListener(r,l,s)),i=N(()=>{const o=W(c(e[0])).filter(r=>r!=null);return o.every(r=>typeof r!="string")?o:void 0}),d=ae(()=>{var o,r;return[(r=(o=i.value)==null?void 0:o.map(l=>Ye(l)))!=null?r:[Ke].filter(l=>l!=null),W(c(i.value?e[1]:e[0])),W(C(i.value?e[2]:e[1])),c(i.value?e[3]:e[2])]},([o,r,l,s])=>{if(t(),!(o!=null&&o.length)||!(r!=null&&r.length)||!(l!=null&&l.length))return;const v=oe(s)?{...s}:s;n.push(...o.flatMap(h=>r.flatMap(g=>l.map(m=>a(h,g,m,v)))))},{flush:"post"}),p=()=>{d(),t()};return G(t),p}const Xe=ne({name:"UseDraggable",props:["storageKey","storageType","initialValue","exact","preventDefault","stopPropagation","pointerTypes","as","handle","axis","onStart","onMove","onEnd","disabled","buttons","containerElement"],setup(e,{slots:n}){const t=B(),a=N(()=>{var s;return(s=c(e.handle))!=null?s:t.value}),i=N(()=>{var s;return(s=e.containerElement)!=null?s:void 0}),d=N(()=>!!e.disabled),p=e.storageKey&&He(e.storageKey,c(e.initialValue)||{x:0,y:0},$?e.storageType==="session"?sessionStorage:localStorage:void 0),o=p||e.initialValue||{x:0,y:0},l=he(Je(t,{...e,handle:a,initialValue:o,onEnd:(s,v)=>{var h;(h=e.onEnd)==null||h.call(e,s,v),p&&(p.value.x=s.x,p.value.y=s.y)},disabled:d,containerElement:i}));return()=>{if(n.default)return ye(e.as||"div",{ref:t,style:`touch-action:none;${l.style}`},n.default(l))}}});function U(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function ie(e){const n=window.getComputedStyle(e);if(n.overflowX==="scroll"||n.overflowY==="scroll"||n.overflowX==="auto"&&e.clientWidth<e.scrollWidth||n.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const t=e.parentNode;return!t||t.tagName==="BODY"?!1:ie(t)}}function Ge(e){const n=e||window.event,t=n.target;return ie(t)?!1:n.touches.length>1?!0:(n.preventDefault&&n.preventDefault(),!1)}const X=new WeakMap;function Qe(e,n=!1){const t=B(n);let a=null,i="";V(re(e),o=>{const r=U(c(o));if(r){const l=r;if(X.get(l)||X.set(l,l.style.overflow),l.style.overflow!=="hidden"&&(i=l.style.overflow),l.style.overflow==="hidden")return t.value=!0;if(t.value)return l.style.overflow="hidden"}},{immediate:!0});const d=()=>{const o=U(c(e));!o||t.value||(Z&&(a=Ue(o,"touchmove",r=>{Ge(r)},{passive:!1})),o.style.overflow="hidden",t.value=!0)},p=()=>{const o=U(c(e));!o||!t.value||(Z&&(a==null||a()),o.style.overflow=i,X.delete(o),t.value=!1)};return G(p),N({get(){return t.value},set(o){o?d():p()}})}function Ze(){let e=!1;const n=B(!1);return(t,a)=>{if(n.value=a.value,e)return;e=!0;const i=Qe(t,a.value);V(n,d=>i.value=d)}}Ze();const qe=ne({__name:"Popup",props:{componentName:{},width:{},height:{}},emits:["closure"],setup(e,{emit:n}){const t=e,a=n,i=t.componentName+"-draggable",d={x:(window.innerWidth-t.width)/2,y:(window.innerHeight-t.height)/2},p=T(),o=T();let r=!1;function l(){r=!0}function s(){if(r){r=!1;const v=o.value.$el,h=v.getBoundingClientRect();let{x:g,y:m}=h;g=Math.min(Math.max(0,g),window.innerWidth-100),m=Math.min(Math.max(0,m),window.innerHeight-100),(h.x!=g||h.y!=m)&&(v.style.left=g+"px",v.style.top=m+"px",localStorage.setItem(i,JSON.stringify({x:g,y:m})))}}return window.addEventListener("mouseup",s),me(()=>{window.removeEventListener("mouseup",s)}),(v,h)=>{var g;return we(),Se(C(Xe),{ref_key:"useDraggableRef",ref:o,"storage-key":i,"storage-type":"local",handle:(g=p.value)==null?void 0:g.triggerRef,"initial-value":d,class:"popup",style:be({width:t.width+"px",height:t.height+"px"}),onMousedown:l},{default:J(()=>[Q("header",null,[K(C(Oe),{ref_key:"handleRef",ref:p},{default:J(()=>[Y(v.$slots,"header",{},void 0,!0)]),_:3},512),K(C(Me),null,{default:J(()=>[Y(v.$slots,"tool",{},void 0,!0),Q("div",{class:"clickable",onClick:h[0]||(h[0]=m=>a("closure"))},[K(C(Ee),{size:"22",component:C(xe)},null,8,["component"])])]),_:3})]),Y(v.$slots,"default",{},void 0,!0)]),_:3},8,["handle","style"])}}}),tt=De(qe,[["__scopeId","data-v-1ea9ceb9"]]);export{tt as P};
